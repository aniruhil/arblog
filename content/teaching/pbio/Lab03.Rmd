---
title: "Lab 3"
author: "Ani Ruhil"
date: "January 25, 2016"
output:
  html_document:
    highlight: tango
    theme: readable
    toc: yes
  fontsize: 10
  word_document:
    highlight: tango
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Practice Problem 1
Systolic blood pressure was measured (in units of mm Hg) during preventative health examinations on people in Dallas, Texas. Here are the measurements for some of these patients:

```{r}
y = c(112, 128, 108, 129, 125, 153, 155, 132, 137)

```

(a) Calculate the mean and the standard deviation for these data.

```{r}
mean.y = mean(y)
sd.y =sd(y)
mean.y; sd.y
```

The mean is 131 mm Hg and the standard deviation is 15.93 mm Hg.

(b) What is the sample size? 

```{r}
n = length(y)
n
```

(c) Calculate the standard error of the mean. 

```{r}
se.y = sd.y / sqrt(n)
se.y
```

The standard error of the mean is 5.31

(d) Using the 2SE rule of thumb, calculate an approximate 95% confidence interval for the mean. List the lower and upper limits.

```{r}
lower.CI.limit = mean.y - (2 * se.y)
upper.CI.limit = mean.y + (2 * se.y)
lower.CI.limit; upper.CI.limit
```

The lower and upper limits of the confidence interval are 120.36 mm Hg and 141.63 mm Hg. 

(e) How would we interpret the 95% confidence interval? 

We can be about 95% certain that the population mean of systolic blood pressure lies in the range of values given by 120.36 mm Hg and 141.63 mm Hg. 

(f) Draw a strip-chart with the mean and the standard errors overlaid on the data.

```{r}
par(bty = "l") # Just draw x-axis and y-axis; no box around the plot

stripchart(y, vertical = TRUE, method = "jitter", jitter = 0.01, pch = 16, ylab = "Blood Pressure (in mm Hg)", col = "cadetblue1", cex = 1, las = 1, ylim = c(0, max(y)))

points(mean.y, pch = 16, cex = 1.2)

arrows( c(1), mean.y - se.y, c(1), mean.y + se.y,   angle = 90, code = 3, length = 0.1)

```

# Practice Problem 7
Niderkorn's (1872) measurements on 114 human corpses provided the first quantitative study on the development of rigor mortis. These data, given below, reflect the number of hours it took a body to achieve rigor mortis after death. Note the data have been rounded to the nearest hour (hence there are no decimal places). 

```{r}
rmortis = read.csv("http://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter03/chap03q09Rigormortis.csv")
```

(a) What is the average time to rigor mortis for these data?

```{r}
mean.hours = mean(rmortis$hours)
mean.hours
```

The average time to rigor mortis is 5.68 hours.

(b) What is the standard deviation?

```{r}
sd.hours = sd(rmortis$hours)
sd.hours
```

The standard deviation is 2.36 hours.

(c) Calculate and interpret the standard error for the mean of these data.

```{r}
n.hours = length(rmortis$hours)
n.hours

se.hours = sd.hours / sqrt(n.hours)
se.hours
```

The standard error is 0.22 hours, and this can be interpreted as the average difference we might expect, between our sample mean and the population, in a random sample of 114 cadavers.

(d) What is the approximate 95% confidence interval for the sample mean you estimated earlier? How would we interpret the lower and upper limits of this interval?

```{r}
lower.CI = mean.hours - (2 * se.hours)
upper.CI = mean.hours + (2 * se.hours)
lower.CI; upper.CI
```

The approximate 95% interval is 5.24 and 6.12 hours. The interpretation would be that we can be about 95% certain that for the population at large the average time to rigor mortis falls between 5.24 and 6.12 hours.  

(e) Draw a strip-chart with the mean and the standard errors overlaid on the data.

```{r}
par(bty = "l") # Just draw x-axis and y-axis; no box around the plot

stripchart(rmortis$hours, vertical = TRUE, method = "jitter", jitter = 0.01, pch = 16, ylab = "Time to Rigor Mortis (in hours)", col = "cadetblue1", cex = 1, las = 1, ylim = c(0, max(rmortis$hours)))

points(mean.hours, pch = 16, cex = 1.2)

arrows( c(1), mean.hours - se.hours, c(1), mean.hours + se.hours,   angle = 90, code = 3, length = 0.1)

```

# Your Turn ...
The data below document the flash duration, in milliseconds, of a sample of 35 male fireflies of the species _Photinus Ignitus_. 


```{r}

flash = read.csv("http://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter04/chap04q07FireflyFlash.csv")


mean = mean(flash$flash)
sd = sd(flash$flash)
n = 70
se = sd / sqrt(n)

ci.low = mean - (2*se)
ci.high = mean + (2*se)

```

(a) Calculate the sample mean and the sample standard deviation.

(b) Calculate the standard error and interpret it.

(c) Calculate the approximate 95% confidence interval for the mean flash duration. 

(d) Interpret the confidence interval you calculated above.

(e) Draw a strip chart with the mean and standard error superimposed on the data.

(f) If you had twice the sample size, say for 70 male fireflies, would your estimated standard error be smaller or larger? What would be the consequence for the approximate 95% confidence interval -- would it be wider or narrower than what you calculated above? Show your conclusions by:

* using a sample size of 70 to calculate the new standard error 
* then using the new standard error to calculate the approximate 95% confidence interval for mean flash duration of male fireflies

