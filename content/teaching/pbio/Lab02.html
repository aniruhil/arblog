---
title: "Lab 2"
author: "Ani Ruhil"
date: "January 22, 2016"
output:
  html_document:
    highlight: tango
    theme: readable
    toc: yes
  fontsize: 10
  word_document:
    highlight: tango
    toc: yes
---



<div id="installing-and-loading-packages" class="section level1">
<h1>Installing and Loading packages</h1>
<p>Use the “Tools” menu to select “Install Packages…” and enter the following package name(s) or run the command as shown below:</p>
<pre class="r"><code>packs = c(&quot;vcd&quot;, &quot;vcdExtra&quot;, &quot;dplyr&quot;)
# install.packages(packs, dependencies = TRUE, repos=&quot;https://cran.rstudio.com&quot;)</code></pre>
<p>Remember to removed the <code>#</code> symbol in line 25 before running the <code>install.packages</code> command. Then once you are done installing these packages go ahead and reinsert the <code>#</code> symbol.</p>
<hr />
</div>
<div id="problem-a" class="section level1">
<h1>Problem (a)</h1>
<p>More than 10% of people carry the parasite <em>Taxoplasma gondii</em>. The data (see below) are from Prague and provide information on 15-29 year-old drivers who were in an accident. Some of these drivers were infected with the parasite and others were not. Other drivers represent those who were not in an accident, and some of these drivers are infected while others are not infected.</p>
<pre class="r"><code>taxo = read.csv(&quot;http://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter02/chap02q32ToxoplasmaAccidents.csv&quot;)</code></pre>
<pre><code>(i) What variable types are these? Numeric or categorical? If categorical, are they nominal or ordinal?  


(ii) The goal here is to analyze the data to see if there is any association (any relationship) between being infected and being involved in a car accident. Use an appropriate table to carry out this analysis.</code></pre>
<pre class="r"><code>tab.1 = table(taxo$driverType, taxo$infectionStatus)
tab.1</code></pre>
<pre><code>##            
##             infected uninfected
##   accidents       21         38
##   control         38        211</code></pre>
<pre class="r"><code>tab.2 = prop.table(tab.1, 2)  # row proportions
tab.2</code></pre>
<pre><code>##            
##              infected uninfected
##   accidents 0.3559322  0.1526104
##   control   0.6440678  0.8473896</code></pre>
<pre class="r"><code>tab.3 = tab.2 * 100
tab.3 </code></pre>
<pre><code>##            
##             infected uninfected
##   accidents 35.59322   15.26104
##   control   64.40678   84.73896</code></pre>
<p>What conclusions can we draw? Why?</p>
<pre><code>(iii) Depict this association with an appropriate graphic. </code></pre>
<pre class="r"><code>barplot(tab.3, ylim=c(0, 100), beside=TRUE, xlab=&quot;Infection Status&quot;, ylab=&quot;Relative Frequencies (%)&quot;)</code></pre>
<p><img src="/teaching/pbio/Lab02_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>mosaicplot(tab.3, main=&quot;Mosaicplot of Infection Status &amp; Accidents&quot;)</code></pre>
<p><img src="/teaching/pbio/Lab02_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<p>Both plots show a higher rate of accidents for the infected group.</p>
</div>
<div id="problem-b" class="section level1">
<h1>Problem (b)</h1>
<p>Mattison et al. (2012) carried out a study with rhesus monkeys to see if a reduction in food intake extends life span (measured in years). The data 9see below) are the life spans of 19 Male and 15 Female monkeys. Monkeys were randomly assigned either to a normal nutritious diet group or to a similar diet but reduced by 30% in terms of the quantity of food.</p>
<pre class="r"><code>rhesus = read.csv(&quot;http://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter02/chap02q35FoodReductionLifespan.csv&quot;)</code></pre>
<pre><code>(i) What types of variables are these? Numeric? Categorical? If categorical, are they nominal or ordinal?



(ii) Calculate the Mean, Median, Variance, Standard Deviation for each group. </code></pre>
<pre class="r"><code>library(dplyr)

grouped = group_by(rhesus, sex, foodTreatment)

tab.A = summarise(grouped,
        Mean = mean(lifespan, na.rm=TRUE),
        Median = median(lifespan, na.rm=TRUE),
        Variance = var(lifespan, na.rm=TRUE),
        Std.Dev = sd(lifespan, na.rm=TRUE)
        )

tab.A</code></pre>
<pre><code>## # A tibble: 4 x 6
## # Groups: sex [?]
##   sex    foodTreatment  Mean Median Variance Std.Dev
##   &lt;fctr&gt; &lt;fctr&gt;        &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1 female control        28.7   27.1     22.2    4.71
## 2 female reduced        26.1   27.8     48.9    6.99
## 3 male   control        33.3   34.1     32.9    5.73
## 4 male   reduced        34.7   37.0     36.4    6.03</code></pre>
<p>You could also do this with another package (see below):</p>
<pre class="r"><code>library(psych)

describeBy(rhesus$lifespan, list(rhesus$sex, rhesus$foodTreatment))</code></pre>
<pre><code>## 
##  Descriptive statistics by group 
## : female
## : control
##    vars n  mean   sd median trimmed  mad  min  max range skew kurtosis
## X1    1 8 28.68 4.71   27.1   28.68 4.45 23.7 35.2  11.5 0.28    -1.94
##      se
## X1 1.66
## -------------------------------------------------------- 
## : male
## : control
##    vars n  mean   sd median trimmed  mad  min  max range skew kurtosis
## X1    1 9 33.33 5.73   34.1   33.33 6.67 24.9 40.7  15.8 -0.3    -1.56
##      se
## X1 1.91
## -------------------------------------------------------- 
## : female
## : reduced
##    vars n  mean   sd median trimmed  mad  min  max range  skew kurtosis
## X1    1 7 26.09 6.99   27.8   26.09 7.71 16.5 35.9  19.4 -0.07    -1.73
##      se
## X1 2.64
## -------------------------------------------------------- 
## : male
## : reduced
##    vars  n  mean   sd median trimmed  mad  min  max range  skew kurtosis
## X1    1 10 34.69 6.03     37   35.38 4.74 23.7 40.2  16.5 -0.51    -1.44
##      se
## X1 1.91</code></pre>
<p>Here you are getting a lot more statistics than we need to deal with but if you find this easier to use, by all means do so.</p>
<pre><code>(iii) Which group has higher average life spans, regardless of gender?



(iv) Within gender, which group has the higher average life span?



(v) Looking at the picture as a whole, what differences in life spans do you see between the male and female rhesus monkeys in this experiment? 



(vi) If we had to display these data, what would be some appropriate ways to do so? 



(vii) Let us go ahead and generate some of these plots and then compare them to see if the distribution of life spans is symmetric or skewed, and if it is skewed, the direction of the skew.</code></pre>
<pre class="r"><code>library(lattice)

# Histogram
histogram(~ lifespan | sex:foodTreatment, data=rhesus, layout=c(1,4), xlab=&quot;Life span (in years)&quot;)</code></pre>
<p><img src="/teaching/pbio/Lab02_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code># Box-plot
boxplot(lifespan ~ sex:foodTreatment, data=rhesus, horizontal=TRUE, 
        xlab=&quot;Life span (in years)&quot;,
        ylab = &quot;Group&quot;,
        cex.axis = 0.75)</code></pre>
<p><img src="/teaching/pbio/Lab02_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre class="r"><code># Strip Chart 
par(bty = &quot;l&quot;) # plot x and y axes only, not a complete box

stripchart(lifespan ~ sex:foodTreatment, data = rhesus, vertical = TRUE, method = &quot;jitter&quot;, pch = 16, col = &quot;forestgreen&quot;, cex = 1, las = 1, ylab = &quot;Life span (in years)&quot;, xlab = &quot;Group&quot;, ylim = c(0, 50))

# calculate mean life span for each group
means = tapply(rhesus$lifespan, list(rhesus$sex, rhesus$foodTreatment), mean)

# &quot;segments&quot; draws draws lines to indicate the means
segments(x0 = c(1, 2, 3, 4) - 0.1, y0 = means, x1 = c(1, 2, 3, 4) + 0.1,
         y1 = means, lwd = 2, col = &quot;brown&quot;)</code></pre>
<p><img src="/teaching/pbio/Lab02_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<p>What can you say about symmetry versus skew (and the direction of the skew)?</p>
<pre><code>(viii) What measure would be most appropriate, then, to describe the average lifespan for any of these groups?</code></pre>
</div>
<div id="practice-problem" class="section level1">
<h1>Practice Problem</h1>
<p>Chapter 3, #6 – Body Mass (in grams) and beak length (in mm) of finches captured in mist nets in Kenya (Schluter 1988)</p>
<pre class="r"><code>finches = read.csv(&quot;http://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter03/chap03q04KenyaFinches.csv&quot;)</code></pre>
<pre><code>(1) Calculate mean, median, variance, standard deviation of (a) body mass, and beak length

(2) Depict (a) body mass and (b) beak length with an appropriate graphic

(3) Calculate how many finches do we have of each species and express in a table as proportions, percentages

(4) Depict species&#39; proportions with an appropriate graphic</code></pre>
</div>
