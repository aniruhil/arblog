---
title: "Lab 2"
author: "Ani Ruhil"
date: "January 22, 2016"
output:
  html_document:
    highlight: tango
    theme: readable
    toc: yes
  fontsize: 10
  word_document:
    highlight: tango
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Installing and Loading packages
Use the  "Tools" menu to select "Install Packages..." and enter the following package name(s) or run the command as shown below:

```{r}
packs = c("vcd", "vcdExtra", "dplyr")
# install.packages(packs, dependencies = TRUE, repos="https://cran.rstudio.com")
```

Remember to removed the <code>#</code> symbol in line 25 before running the <code>install.packages</code> command. Then once you are done installing these packages go ahead and reinsert the <code>#</code> symbol. 

--------------

# Problem (a)

More than 10% of people carry the parasite _Taxoplasma gondii_. The data (see below) are from Prague and provide information on 15-29 year-old drivers who were in an accident. Some of these drivers were infected with the parasite and others were not. Other drivers represent those who were not in an accident, and some of these drivers are infected while others are not infected.  

```{r}
taxo = read.csv("http://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter02/chap02q32ToxoplasmaAccidents.csv")
```

    (i) What variable types are these? Numeric or categorical? If categorical, are they nominal or ordinal?  


    (ii) The goal here is to analyze the data to see if there is any association (any relationship) between being infected and being involved in a car accident. Use an appropriate table to carry out this analysis.

  

```{r}    
tab.1 = table(taxo$driverType, taxo$infectionStatus)
tab.1

tab.2 = prop.table(tab.1, 2)  # row proportions
tab.2

tab.3 = tab.2 * 100
tab.3 
```

What conclusions can we draw? Why?

    (iii) Depict this association with an appropriate graphic. 

 

```{r}
barplot(tab.3, ylim=c(0, 100), beside=TRUE, xlab="Infection Status", ylab="Relative Frequencies (%)")

mosaicplot(tab.3, main="Mosaicplot of Infection Status & Accidents")
```

Both plots show a higher rate of accidents for the infected group.


# Problem (b)
Mattison et al. (2012) carried out a study with rhesus monkeys to see if a reduction in food intake extends life span (measured in years). The data 9see below) are the life spans of 19 Male and 15 Female monkeys. Monkeys were randomly assigned either to a normal nutritious diet group or to a similar diet but reduced by 30% in terms of the quantity of food. 

```{r}
rhesus = read.csv("http://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter02/chap02q35FoodReductionLifespan.csv")
```

    (i) What types of variables are these? Numeric? Categorical? If categorical, are they nominal or ordinal?



    (ii) Calculate the Mean, Median, Variance, Standard Deviation for each group. 

```{r, message=FALSE, warning=FALSE}
library(dplyr)

grouped = group_by(rhesus, sex, foodTreatment)

tab.A = summarise(grouped,
        Mean = mean(lifespan, na.rm=TRUE),
        Median = median(lifespan, na.rm=TRUE),
        Variance = var(lifespan, na.rm=TRUE),
        Std.Dev = sd(lifespan, na.rm=TRUE)
        )

tab.A
```

You could also do this with another package (see below):

```{r, warning=FALSE, message=FALSE}
library(psych)

describeBy(rhesus$lifespan, list(rhesus$sex, rhesus$foodTreatment))
```

Here you are getting a lot more statistics than we need to deal with but if you find this easier to use, by all means do so.


    (iii) Which group has higher average life spans, regardless of gender?



    (iv) Within gender, which group has the higher average life span?



    (v) Looking at the picture as a whole, what differences in life spans do you see between the male and female rhesus monkeys in this experiment? 



    (vi) If we had to display these data, what would be some appropriate ways to do so? 



    (vii) Let us go ahead and generate some of these plots and then compare them to see if the distribution of life spans is symmetric or skewed, and if it is skewed, the direction of the skew.


```{r}
library(lattice)

# Histogram
histogram(~ lifespan | sex:foodTreatment, data=rhesus, layout=c(1,4), xlab="Life span (in years)")

# Box-plot
boxplot(lifespan ~ sex:foodTreatment, data=rhesus, horizontal=TRUE, 
        xlab="Life span (in years)",
        ylab = "Group",
        cex.axis = 0.75)

# Strip Chart 
par(bty = "l") # plot x and y axes only, not a complete box

stripchart(lifespan ~ sex:foodTreatment, data = rhesus, vertical = TRUE, method = "jitter", pch = 16, col = "forestgreen", cex = 1, las = 1, ylab = "Life span (in years)", xlab = "Group", ylim = c(0, 50))

# calculate mean life span for each group
means = tapply(rhesus$lifespan, list(rhesus$sex, rhesus$foodTreatment), mean)

# "segments" draws draws lines to indicate the means
segments(x0 = c(1, 2, 3, 4) - 0.1, y0 = means, x1 = c(1, 2, 3, 4) + 0.1,
         y1 = means, lwd = 2, col = "brown")
```


What can you say about symmetry versus skew (and the direction of the skew)?



    (viii) What measure would be most appropriate, then, to describe the average lifespan for any of these groups?




# Practice Problem

Chapter 3, #6 -- Body Mass (in grams) and beak length (in mm) of finches captured in mist nets in Kenya (Schluter 1988)

```{r}
finches = read.csv("http://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter03/chap03q04KenyaFinches.csv")
```

    (1) Calculate mean, median, variance, standard deviation of (a) body mass, and beak length
    
    (2) Depict (a) body mass and (b) beak length with an appropriate graphic
    
    (3) Calculate how many finches do we have of each species and express in a table as proportions, percentages

    (4) Depict species' proportions with an appropriate graphic








